# @format

language: node_js
node_js:
  - 12 # uses version 12
services:
  - postgresql # starts up postgres
addons:
  postgresql: '10' # recent postgres version on Travis
dist: trusty # uses xenial environment
sudo: false
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "mapitpostgrad-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)
script:
  - npm test # test the code
  # - npm run build-client # make the bundle
before_deploy:
   - rm -rf node_modules # omit from the tarball, since we skip cleanup
 deploy:
   skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
   app: mapitapp # see README
   api_key:
      secure: "uoSuHuy/K25VgoZHwVdR/3e/kc6Cp0smhIA93mPdjSrngdBkh6qrPRMuLjTVQi+YkvgBJaVFPPFBJcHvjTzx3nYhr1RM84ZKtRau2vxFMLpgbW4JCaq9j+rM9iVagNAc7PCXLrVK8uw7D4eoAnrIi6g7eTzoMPDW9mqeK7Q2cBZKK/hntdgoQlcAKNyPHNaL8uOA5EAFZjsIgnAy0MC+vZJW77DE525V/KnG5om3rnksYOst+0CCkKFuIcG1aeOe66D4b6cA09irgFL+E70SPjG6qI/5cW65uuG4LlciHAMP9rmAYlqe5I2yGBkTYffhYzNo6EBLzzKJEKUFjzTtQfCumrHs3FVm3lp/vntzjfi7uEZcSayOiuo0ovG1ONRsQWk3UPMC0Ufl48RTE63ZnOTJ39G78qkegrkToEjePTMag2Ls0CEAuIElj3AnDGKrpTjQQLsovbdTr6Mfo90Rvhc09dWISfRJ14p/ZuTdEdH+wdTyZqG2vMeI33tgWw25/ylNNhxOljJUo1OiAKRPLqOhQafseIrCyT+hHKXMOPLb9qGQEVPYtW9635Z2gxKIYaaqFIoOfp5+dp/6+8EUPUg6IPQX8jTys8u5d7F5ZUGQdpfSpBnEvhgaF93094/Sl6WYXTG0EtCdu82RCJpTAV2UlIxeGV0IAzcoS5VgUc8="
